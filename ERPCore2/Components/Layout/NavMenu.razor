@rendermode @(new Microsoft.AspNetCore.Components.Web.InteractiveServerRenderMode())
@using Microsoft.AspNetCore.Components.Authorization
@using ERPCore2.Components.Shared
@using ERPCore2.Components.Shared.NavMenus
@using ERPCore2.Components.Shared.Auth
@inject AuthenticationStateProvider AuthenticationStateProvider

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <a class="navbar-brand" href="">美莊磚業</a>
        <AuthorizeView>
            <Authorized>
                <div class="d-flex align-items-center">
                    <span class="text-white me-3">歡迎，@(context.User.FindFirst(System.Security.Claims.ClaimTypes.GivenName)?.Value ?? context.User.Identity?.Name)</span>
                    <a href="/auth/signout" class="btn btn-sm btn-outline-light">登出</a>
                </div>
            </Authorized>
            <NotAuthorized>
                <div class="d-flex align-items-center">
                    <a href="/auth/login" class="btn btn-sm btn-outline-light">登入</a>
                </div>
            </NotAuthorized>
        </AuthorizeView>
    </div>
</div>

<input type="checkbox" title="Navigation menu" class="navbar-toggler" />

<div class="nav-scrollable">    
    <nav class="nav flex-column">

        <!-- 首頁 -->
        <NavMenuItem Text="首頁" IconClass="bi bi-house-door-fill-nav-menu" Url="/" />    

        <!-- 員工管理下拉選單 -->
        <NavMenuItem Text="員工管理" IconClass="bi bi-person-badge-fill" MenuKey="employee_management">
            <DropdownItems>
                <NavDropdownItem Text="員工維護" Url="/employees" RequiredPermission="Employee.Read" ParentMenuKey="employee_management" IconClass="bi bi-caret-right-fill"/>
                <NavDropdownItem Text="部門" Url="/departments" RequiredPermission="Department.Read" ParentMenuKey="employee_management"/>
                <NavDropdownItem Text="職位" Url="/employee-positions" RequiredPermission="EmployeePosition.Read" ParentMenuKey="employee_management"/>   
                <NavDropdownItem Text="角色權限" Url="/employees/role-permission-management" RequiredPermission="Role.Read" ParentMenuKey="employee_management" IconClass="bi bi-caret-right-fill"/>
                <NavDropdownItem Text="角色" Url="/roles" RequiredPermission="Role.Read" ParentMenuKey="employee_management"/>       
                <NavDropdownItem Text="權限" Url="/permissions" RequiredPermission="Permission.Read" ParentMenuKey="employee_management"/>     
            </DropdownItems>
        </NavMenuItem>

        <!-- 廠商管理下拉選單 -->
        <NavMenuItem Text="廠商管理" IconClass="bi bi-building-gear" MenuKey="supplier_management">
            <DropdownItems>
                <NavDropdownItem Text="廠商維護" Url="/suppliers" RequiredPermission="Supplier.Read" ParentMenuKey="supplier_management" IconClass="bi bi-caret-right-fill" />
                <NavDropdownItem Text="類型" Url="/supplier-types" RequiredPermission="SupplierType.Read" ParentMenuKey="supplier_management"/>
            </DropdownItems>
        </NavMenuItem>

        <!-- 客戶管理下拉選單 -->
        <NavMenuItem Text="客戶管理" IconClass="bi bi-people-fill" MenuKey="customer_management">
            <DropdownItems>
                <NavDropdownItem Text="客戶維護" Url="/customers" RequiredPermission="Customer.Read" ParentMenuKey="customer_management" IconClass="bi bi-caret-right-fill"/>
                <NavDropdownItem Text="類型" Url="/customer-types" RequiredPermission="CustomerType.Read" ParentMenuKey="customer_management"/>               
            </DropdownItems>
        </NavMenuItem>

        <!-- 產品管理下拉選單 -->
        <NavMenuItem Text="產品管理" IconClass="bi bi-box-seam-fill" MenuKey="product_management">
            <DropdownItems>
                <NavDropdownItem Text="產品維護" Url="/products" RequiredPermission="Product.Read" ParentMenuKey="product_management" IconClass="bi bi-caret-right-fill"/>
                @* <NavDropdownItem Text="產品定價" Url="/product-pricing" RequiredPermission="ProductPricing.Read" ParentMenuKey="product_management" IconClass="bi bi-caret-right-fill"/> *@
                <NavDropdownItem Text="類型" Url="/product-categories" RequiredPermission="ProductCategory.Read" ParentMenuKey="product_management"/> 
                <NavDropdownItem Text="單位" Url="/units" RequiredPermission="Unit.Read" ParentMenuKey="product_management"/>
                <NavDropdownItem Text="尺寸" Url="/sizes" RequiredPermission="Size.Read" ParentMenuKey="product_management" />                                                                                        
            </DropdownItems>
        </NavMenuItem>      

        <!-- 庫存管理下拉選單 -->
        <NavMenuItem Text="庫存管理" IconClass="bi-boxes nav-menu-bi" MenuKey="inventory_management">
            <DropdownItems>
                <NavDropdownItem Text="倉庫維護" Url="/warehouses" RequiredPermission="Warehouse.Read" ParentMenuKey="inventory_management" IconClass="bi bi-caret-right-fill"/>

                @* <NavDropdownItem Text="庫存查詢" Url="/inventory/stock" RequiredPermission="InventoryStock.Read" ParentMenuKey="inventory_management" />
                <NavDropdownItem Text="庫存預留" Url="/inventory/reservations" RequiredPermission="InventoryReservation.Read" ParentMenuKey="inventory_management" />                
                <NavDropdownItem Text="庫存盤點" Url="/inventory/stock-taking" RequiredPermission="StockTaking.Read" ParentMenuKey="inventory_management" />
                <NavDropdownItem Text="庫存異動記錄" Url="/inventory/transactions" RequiredPermission="InventoryTransaction.Read" ParentMenuKey="inventory_management" />
                <NavDropdownItem Text="庫存異動類型" Url="/inventory-transaction-types" RequiredPermission="InventoryTransactionType.Read" ParentMenuKey="inventory_management" /> *@
            </DropdownItems>
        </NavMenuItem>    

        <!-- 採購管理下拉選單 -->
        <NavMenuItem Text="採購管理" IconClass="bi bi-truck" MenuKey="purchase_management">
            <DropdownItems>
                <NavDropdownItem Text="採購單維護" Url="/purchase/orders" RequiredPermission="Purchase.Read" ParentMenuKey="purchase_management" IconClass="bi bi-caret-right-fill"/>
                @* <NavDropdownItem Text="入庫" Url="/purchase-receivings" RequiredPermission="PurchaseReceiving.Read" ParentMenuKey="purchase_management" />
                <NavDropdownItem Text="退回" Url="/purchase-returns" RequiredPermission="PurchaseReturn.Read" ParentMenuKey="purchase_management" /> *@
            </DropdownItems>
        </NavMenuItem>     
        
        <!-- 銷貨管理下拉選單 -->
        @* <NavMenuItem Text="銷貨管理" IconClass="bi bi-cart-fill" MenuKey="sales_management">
            <DropdownItems>
                <NavDropdownItem Text="銷貨訂單" Url="/sales-orders" RequiredPermission="SalesOrder.Read" ParentMenuKey="sales_management" />
                <NavDropdownItem Text="銷貨出貨" Url="/sales-deliveries" RequiredPermission="SalesDelivery.Read" ParentMenuKey="sales_management" />
                <NavDropdownItem Text="銷貨退回" Url="/sales-returns" RequiredPermission="SalesReturn.Read" ParentMenuKey="sales_management" />
            </DropdownItems>
        </NavMenuItem> *@



        <!-- 製程管理下拉選單 -->
        @* <NavMenuItem Text="製程管理" IconClass="bi bi-list-nested" MenuKey="process_management">
            <DropdownItems>
                <NavDropdownItem Text="顏色" Url="/colors" RequiredPermission="Color.Read" ParentMenuKey="process_management" /> 
                <NavDropdownItem Text="天氣" Url="/weather" RequiredPermission="Weather.Read" ParentMenuKey="process_management" />   
                <NavDropdownItem Text="材質" Url="/materials" RequiredPermission="Material.Read" ParentMenuKey="process_management" />   
            </DropdownItems>
        </NavMenuItem> *@

        <!-- 系統管理下拉選單 -->
        <NavMenuItem Text="系統管理" IconClass="bi bi-gear-fill" MenuKey="system_management">
            <DropdownItems>
                <NavDropdownItem Text="更新紀錄" Url="/updates" RequiredPermission="SystemControl.Read" ParentMenuKey="system_management" IconClass="bi bi-caret-right-fill"/>
                <NavDropdownItem Text="錯誤記錄" Url="/error-logs" RequiredPermission="SystemControl.Read" ParentMenuKey="system_management" IconClass="bi bi-caret-right-fill"/>
                <NavDropdownItem Text="刪除記錄" Url="/deleted-records" RequiredPermission="SystemControl.Read" ParentMenuKey="system_management" IconClass="bi bi-caret-right-fill"/>
            </DropdownItems>
        </NavMenuItem>
    </nav>
</div>
