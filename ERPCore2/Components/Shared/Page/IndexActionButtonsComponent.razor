@* Index 頁面動作按鈕組件 - 統一管理新增和重新整理按鈕 *@
<div class="d-flex gap-2">
    @if (ShowAddButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.DarkBlue" Text="新增" 
                               OnClick="HandleAddClick" IsDisabled="@(IsLoading || IsAddDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnAdd)" Title="新增"/>
    }

    @if (ShowBarcodePrintButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.DarkBlue" Text="條碼列印" 
                               OnClick="HandleBarcodePrintClick" IsDisabled="@(IsLoading || IsBarcodePrintDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnBarcodePrint)" Title="條碼列印"/>
    }

    @if (ShowBatchApprovalButton)
    {
        // 先暫時關閉，等完善後再開啟
        @* <GenericButtonComponent Variant="ButtonVariant.Warning" Text="批次審核" 
                               OnClick="HandleBatchApprovalClick" IsDisabled="@(IsLoading || IsBatchApprovalDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnBatchApproval)" Title="批次審核"/> *@
    }

    @if (ShowBatchPrintButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.Blue" Text="報表列印" 
                               OnClick="HandleBatchPrintClick" IsDisabled="@(IsLoading || IsBatchPrintDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnBatchPrint)" Title="報表列印"/>
    }

    @if (ShowImportScheduleButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.Blue" Text="排程入庫"
                               OnClick="HandleImportScheduleClick" IsDisabled="@(IsLoading || IsImportScheduleDisabled)"
                               IsLoading="@(IsLoading && LoadingOnImportSchedule)" Title="排程入庫"/>
    }

    @if (ShowBatchDeleteButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.Red" Text="批次刪除"
                               OnClick="HandleBatchDeleteClick" IsDisabled="@(IsLoading || IsBatchDeleteDisabled)"
                               IsLoading="@(IsLoading && LoadingOnBatchDelete)" Title="批次刪除"/>
    }

    @if (ShowRefreshButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.Green" Text="重整" 
                               OnClick="HandleRefreshClick" IsDisabled="@(IsLoading || IsRefreshDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnRefresh)" Title="重整"/>
    }

    @if (ShowExportExcelButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.Gray" Text="匯出Excel" 
                               OnClick="HandleExportExcelClick" IsDisabled="@(IsLoading || IsExportExcelDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnExportExcel)" Title="匯出Excel"/>
    }

    @if (ShowExportPdfButton)
    {
        <GenericButtonComponent Variant="ButtonVariant.Gray" Text="匯出PDF" 
                               OnClick="HandleExportPdfClick" IsDisabled="@(IsLoading || IsExportPdfDisabled)" 
                               IsLoading="@(IsLoading && LoadingOnExportPdf)" Title="匯出PDF"/>
    }

    @* 允許添加自訂按鈕 *@
    @CustomButtons
</div>

@code {    
    // 新增按鈕相關參數
    [Parameter] public bool ShowAddButton { get; set; } = true;
    [Parameter] public string AddButtonText { get; set; } = "新增"; // 保留參數但不使用，固定顯示「新增」
    [Parameter] public string AddButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string AddButtonIconClass { get; set; } = "fas fa-plus";
    [Parameter] public bool IsAddDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnAdd { get; set; } = false;
    [Parameter] public EventCallback OnAddClick { get; set; }    
      
    // 重新整理按鈕相關參數
    [Parameter] public bool ShowRefreshButton { get; set; } = true;
    [Parameter] public string RefreshButtonText { get; set; } = "重整"; // 保留參數但不使用，固定顯示「重整」
    [Parameter] public string RefreshButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string RefreshButtonIconClass { get; set; } = "fas fa-sync";
    [Parameter] public bool IsRefreshDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnRefresh { get; set; } = false;
    [Parameter] public EventCallback OnRefreshClick { get; set; }

    // 匯出Excel按鈕相關參數
    [Parameter] public bool ShowExportExcelButton { get; set; } = false;
    [Parameter] public string ExportExcelButtonText { get; set; } = "匯出Excel"; // 保留參數但不使用，固定顯示「匯出Excel」
    [Parameter] public string ExportExcelButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string ExportExcelButtonIconClass { get; set; } = "fas fa-file-excel";
    [Parameter] public bool IsExportExcelDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnExportExcel { get; set; } = false;
    [Parameter] public EventCallback OnExportExcelClick { get; set; }

    // 匯出PDF按鈕相關參數
    [Parameter] public bool ShowExportPdfButton { get; set; } = false;
    [Parameter] public string ExportPdfButtonText { get; set; } = "匯出PDF"; // 保留參數但不使用，固定顯示「匯出PDF」
    [Parameter] public string ExportPdfButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string ExportPdfButtonIconClass { get; set; } = "fas fa-file-pdf";
    [Parameter] public bool IsExportPdfDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnExportPdf { get; set; } = false;
    [Parameter] public EventCallback OnExportPdfClick { get; set; }

    // 列印按鈕相關參數
    [Parameter] public bool ShowBatchPrintButton { get; set; } = false;
    [Parameter] public string BatchPrintButtonText { get; set; } = "列印"; // 保留參數但不使用，固定顯示「列印」
    [Parameter] public string BatchPrintButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string BatchPrintButtonIconClass { get; set; } = "fas fa-print";
    [Parameter] public bool IsBatchPrintDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnBatchPrint { get; set; } = false;
    [Parameter] public EventCallback OnBatchPrintClick { get; set; }

    // 條碼列印按鈕相關參數
    [Parameter] public bool ShowBarcodePrintButton { get; set; } = false;
    [Parameter] public string BarcodePrintButtonText { get; set; } = "條碼列印"; // 保留參數但不使用，固定顯示「條碼列印」
    [Parameter] public string BarcodePrintButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string BarcodePrintButtonIconClass { get; set; } = "bi bi-upc-scan";
    [Parameter] public bool IsBarcodePrintDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnBarcodePrint { get; set; } = false;
    [Parameter] public EventCallback OnBarcodePrintClick { get; set; }

    // 批次審核按鈕相關參數
    [Parameter] public bool ShowBatchApprovalButton { get; set; } = false;
    [Parameter] public string BatchApprovalButtonText { get; set; } = "批次審核"; // 保留參數但不使用，固定顯示「批次審核」
    [Parameter] public string BatchApprovalButtonTitle { get; set; } = ""; // 保留參數但不使用
    [Parameter] public string BatchApprovalButtonIconClass { get; set; } = "bi bi-check2-all";
    [Parameter] public bool IsBatchApprovalDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnBatchApproval { get; set; } = false;
    [Parameter] public EventCallback OnBatchApprovalClick { get; set; }

    // 排程入庫按鈕相關參數
    [Parameter] public bool ShowImportScheduleButton { get; set; } = false;
    [Parameter] public string ImportScheduleButtonText { get; set; } = "排程入庫";
    [Parameter] public string ImportScheduleButtonTitle { get; set; } = "";
    [Parameter] public string ImportScheduleButtonIconClass { get; set; } = "bi bi-box-arrow-in-down";
    [Parameter] public bool IsImportScheduleDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnImportSchedule { get; set; } = false;
    [Parameter] public EventCallback OnImportScheduleClick { get; set; }

    // 批次刪除按鈕相關參數
    [Parameter] public bool ShowBatchDeleteButton { get; set; } = false;
    [Parameter] public bool IsBatchDeleteDisabled { get; set; } = false;
    [Parameter] public bool LoadingOnBatchDelete { get; set; } = false;
    [Parameter] public EventCallback OnBatchDeleteClick { get; set; }

    // 通用狀態參數
    [Parameter] public bool IsLoading { get; set; } = false;
    
    // 自訂按鈕內容
    [Parameter] public RenderFragment? CustomButtons { get; set; }

    private async Task HandleAddClick()
    {
        if (OnAddClick.HasDelegate && !IsLoading && !IsAddDisabled)
        {
            await OnAddClick.InvokeAsync();
        }
    }

    private async Task HandleRefreshClick()
    {
        if (OnRefreshClick.HasDelegate && !IsLoading && !IsRefreshDisabled)
        {
            await OnRefreshClick.InvokeAsync();
        }
    }

    private async Task HandleExportExcelClick()
    {
        if (OnExportExcelClick.HasDelegate && !IsLoading && !IsExportExcelDisabled)
        {
            await OnExportExcelClick.InvokeAsync();
        }
    }

    private async Task HandleExportPdfClick()
    {
        if (OnExportPdfClick.HasDelegate && !IsLoading && !IsExportPdfDisabled)
        {
            await OnExportPdfClick.InvokeAsync();
        }
    }

    private async Task HandleBatchPrintClick()
    {
        if (OnBatchPrintClick.HasDelegate && !IsLoading && !IsBatchPrintDisabled)
        {
            await OnBatchPrintClick.InvokeAsync();
        }
    }

    private async Task HandleBarcodePrintClick()
    {
        if (OnBarcodePrintClick.HasDelegate && !IsLoading && !IsBarcodePrintDisabled)
        {
            await OnBarcodePrintClick.InvokeAsync();
        }
    }

    private async Task HandleBatchApprovalClick()
    {
        if (OnBatchApprovalClick.HasDelegate && !IsLoading && !IsBatchApprovalDisabled)
        {
            await OnBatchApprovalClick.InvokeAsync();
        }
    }

    private async Task HandleImportScheduleClick()
    {
        if (OnImportScheduleClick.HasDelegate && !IsLoading && !IsImportScheduleDisabled)
        {
            await OnImportScheduleClick.InvokeAsync();
        }
    }

    private async Task HandleBatchDeleteClick()
    {
        if (OnBatchDeleteClick.HasDelegate && !IsLoading && !IsBatchDeleteDisabled)
        {
            await OnBatchDeleteClick.InvokeAsync();
        }
    }
}
