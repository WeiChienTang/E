# å ±è¡¨æª”æ¡ˆæ¶æ§‹èªªæ˜

## æ›´æ–°æ—¥æœŸ
2026-02-04ï¼ˆæ–°å¢ç´™å¼µç‰ˆé¢å‹•æ…‹èª¿æ•´åŠŸèƒ½ï¼Œå ±è¡¨å¯æ ¹æ“šç´™å¼µå°ºå¯¸è‡ªå‹•èª¿æ•´æ¬„ä½å¯¬åº¦ï¼‰

## è¨­è¨ˆç†å¿µ

æœ¬ç³»çµ±å ±è¡¨æ¡ç”¨**ç´”æ–‡å­—æ ¼å¼**ï¼Œå…·æœ‰ä»¥ä¸‹å„ªé»ï¼š
- **ç°¡åŒ–åˆ—å°æµç¨‹**ï¼šä½¿ç”¨ `System.Drawing.Printing` ç›´æ¥åˆ—å°ï¼Œä¸éœ€ HTML è½‰æ›
- **æ¸›å°‘ä¾è³´**ï¼šä¸éœ€è¦ Chromiumã€PDF é–±è®€å™¨ç­‰é¡å¤–è»Ÿé«”
- **é«˜ç›¸å®¹æ€§**ï¼šé©ç”¨æ–¼å„ç¨®å°è¡¨æ©Ÿï¼ŒåŒ…æ‹¬é»é™£å¼ã€æ¨™ç±¤æ©Ÿã€ç†±æ„Ÿæ‡‰å°è¡¨æ©Ÿ
- **æ˜“æ–¼ç¶­è­·**ï¼šæ ¼å¼ç°¡å–®ç›´è§€ï¼Œä½¿ç”¨ç­‰å¯¬å­—å‹ç¢ºä¿å°é½Š
- **å‹•æ…‹ç‰ˆé¢**ï¼šæ ¹æ“šç´™å¼µå°ºå¯¸è‡ªå‹•èª¿æ•´å ±è¡¨æ¬„ä½å¯¬åº¦

### å ±è¡¨é è¦½ Modalï¼ˆReportPreviewModalComponentï¼‰

ç³»çµ±æä¾›çµ±ä¸€çš„å ±è¡¨é è¦½ Modalï¼Œæ•´åˆé è¦½èˆ‡åˆ—å°åŠŸèƒ½ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“„ æ¡è³¼å–®é è¦½                                            [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              [åˆ—å°]  [å–æ¶ˆ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åˆ—å°è¨­å®šå€ï¼š                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ å°è¡¨æ©Ÿ â–¼  â”‚ ç´™å¼µ    â–¼ â”‚ å¼µæ•¸  â”‚ é æ•¸  â”‚ âœ“æº–å‚™å°±ç·’â”‚         â”‚
â”‚  â”‚ HP LaserJet â”‚ A4 (21Ã—29.7cm) â”‚  1   â”‚ 2 é  â”‚          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚     ï¼ˆæ¨¡æ“¬ç´™å¼µå¤–è§€çš„é è¦½å€åŸŸï¼‰                            â”‚  â”‚
â”‚  â”‚     æ ¹æ“šé¸æ“‡çš„ç´™å¼µå°ºå¯¸å‹•æ…‹èª¿æ•´å¤§å°                        â”‚  â”‚
â”‚  â”‚     ä½¿ç”¨ç­‰å¯¬å­—å‹é¡¯ç¤º                                      â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ—å°è¨­å®šæ¬„ä½èªªæ˜ï¼š**
| æ¬„ä½ | èªªæ˜ |
|------|------|
| å°è¡¨æ©Ÿ | ä¸‹æ‹‰é¸å–®ï¼Œå¾ `PrinterConfiguration` è¼‰å…¥å¯ç”¨å°è¡¨æ©Ÿæ¸…å–® |
| ç´™å¼µ | ä¸‹æ‹‰é¸å–®ï¼Œå¾ `PaperSetting` è¼‰å…¥ç´™å¼µè¦æ ¼ï¼ˆé¡¯ç¤ºåç¨±å’Œå°ºå¯¸ï¼‰ï¼Œ**è®Šæ›´æ™‚æœƒé‡æ–°ç”Ÿæˆå ±è¡¨** |
| å¼µæ•¸ | æ•¸å­—è¼¸å…¥ï¼Œè¨­å®šåˆ—å°ä»½æ•¸ï¼ˆ1-99ï¼‰|
| é æ•¸ | å”¯è®€é¡¯ç¤ºï¼Œæ ¹æ“šå ±è¡¨å…§å®¹è‡ªå‹•ä¼°ç®—é æ•¸ |

**åŠŸèƒ½èªªæ˜ï¼š**
- **é è¦½å€åŸŸ**ï¼šé¡¯ç¤ºç´”æ–‡å­—å ±è¡¨å…§å®¹ï¼Œä½¿ç”¨ç­‰å¯¬å­—å‹ç¢ºä¿å°é½Šï¼Œ**æ¨¡æ“¬çœŸå¯¦ç´™å¼µå¤–è§€**
- **å°è¡¨æ©Ÿé¸æ“‡**ï¼šå¯å‹•æ…‹åˆ‡æ›å°è¡¨æ©Ÿï¼Œé è¨­è¼‰å…¥å ±è¡¨é…ç½®çš„å°è¡¨æ©Ÿ
- **ç´™å¼µé¸æ“‡**ï¼šå¯é¸æ“‡ä¸åŒç´™å¼µè¦æ ¼ï¼Œ**è®Šæ›´æ™‚è‡ªå‹•æ ¹æ“šç´™å¼µå°ºå¯¸é‡æ–°ç”Ÿæˆå ±è¡¨**
- **åˆ—å°ä»½æ•¸**ï¼šæ”¯æ´å¤šä»½åˆ—å°ï¼ˆä½¿ç”¨ `PrinterSettings.Copies`ï¼‰
- **åˆ—å°æŒ‰éˆ•**ï¼šç¢ºèªå¾Œç™¼é€åˆ°è¨­å®šçš„å°è¡¨æ©Ÿï¼ˆä½¿ç”¨ `System.Drawing.Printing`ï¼‰
- **å–æ¶ˆæŒ‰éˆ•**ï¼šé—œé–‰ Modal ä¸åˆ—å°

**ä½¿ç”¨æ–¹å¼ï¼ˆæ”¯æ´ç´™å¼µå‹•æ…‹èª¿æ•´ï¼‰ï¼š**
```razor
<ReportPreviewModalComponent IsVisible="@_showPreviewModal"
                             IsVisibleChanged="@((bool visible) => _showPreviewModal = visible)"
                             Title="æ¡è³¼å–®é è¦½"
                             ReportContent="@_reportContent"
                             ReportId="PO001"
                             DocumentName="æ¡è³¼å–®-PO20260204001"
                             OnPrintSuccess="@HandlePrintSuccess"
                             OnPaperLayoutChanged="@HandlePaperLayoutChanged"
                             OnCancel="@(() => _showPreviewModal = false)" />

@code {
    // è™•ç†ç´™å¼µè®Šæ›´äº‹ä»¶ï¼Œæ ¹æ“šæ–°çš„ç‰ˆé¢é…ç½®é‡æ–°ç”Ÿæˆå ±è¡¨
    private async Task HandlePaperLayoutChanged(PaperLayout layout)
    {
        _reportContent = await PurchaseOrderReportService.GeneratePlainTextReportAsync(
            _purchaseOrderId, layout);
        StateHasChanged();
    }
}
```

é€™ç¨®è¨­è¨ˆç¢ºä¿ï¼š
- **å…ˆé è¦½å¾Œåˆ—å°**ï¼šä½¿ç”¨è€…å¯åœ¨åˆ—å°å‰ç¢ºèªå ±è¡¨å…§å®¹
- **éˆæ´»è¨­å®š**ï¼šåˆ—å°å‰å¯èª¿æ•´å°è¡¨æ©Ÿã€ç´™å¼µã€ä»½æ•¸
- **å‹•æ…‹ç‰ˆé¢èª¿æ•´**ï¼šåˆ‡æ›ç´™å¼µæ™‚å ±è¡¨æœƒè‡ªå‹•æ ¹æ“šç´™å¼µå°ºå¯¸èª¿æ•´æ¬„ä½å¯¬åº¦
- **çœŸå¯¦é è¦½**ï¼šé è¦½å€åŸŸæ¨¡æ“¬ç´™å¼µå¤–è§€ï¼Œè®“ä½¿ç”¨è€…çœ‹åˆ°æ¥è¿‘çœŸå¯¦åˆ—å°çš„æ•ˆæœ
- **å¥—ç”¨é è¨­è¨­å®š**ï¼šè‡ªå‹•è¼‰å…¥ã€Œå ±è¡¨åˆ—å°é…ç½®ã€ä¸­çš„é è¨­å°è¡¨æ©Ÿå’Œç´™å¼µ
- **ä¸ä¾è³´ç€è¦½å™¨åˆ—å°**ï¼šç›´æ¥ä½¿ç”¨ `System.Drawing.Printing` ç™¼é€åˆ°å°è¡¨æ©Ÿ
- **é€šç”¨æ€§**ï¼šæ‰€æœ‰å ±è¡¨éƒ½å¯ä½¿ç”¨åŒä¸€å€‹ Modal çµ„ä»¶

---

## ç´™å¼µç‰ˆé¢è¨ˆç®—å™¨ï¼ˆPaperLayoutCalculatorï¼‰

ä½ç½®ï¼š`Helpers/Common/PaperLayoutCalculator.cs`

æ ¹æ“šç´™å¼µè¨­å®šè¨ˆç®—å ±è¡¨ç‰ˆé¢é…ç½®ï¼ŒåŒ…æ‹¬æ¯è¡Œå­—å…ƒæ•¸ã€æ¯é è¡Œæ•¸ç­‰ï¼š

```csharp
// å¾ç´™å¼µè¨­å®šè¨ˆç®—ç‰ˆé¢é…ç½®
var layout = PaperLayoutCalculator.Calculate(paperSetting, fontSize: 10f);

// å–å¾—ç‰ˆé¢è³‡è¨Š
Console.WriteLine($"æ¯è¡Œå­—å…ƒæ•¸: {layout.LineWidth}");
Console.WriteLine($"æ¯é è¡Œæ•¸: {layout.LinesPerPage}");

// è¨ˆç®—è¡¨æ ¼æ¬„ä½å¯¬åº¦ï¼ˆæŒ‰æ¯”ä¾‹èª¿æ•´ï¼‰
int[] baseWidths = { 4, 30, 8, 6, 10, 12, 10 };  // åŸºæ–¼ 80 å­—å…ƒ
int[] adjustedWidths = PaperLayoutCalculator.CalculateColumnWidths(layout, baseWidths);
```

**è¨ˆç®—å…¬å¼ï¼š**
```
å¯ç”¨å¯¬åº¦(cm) = ç´™å¼µå¯¬åº¦ - å·¦é‚Šè· - å³é‚Šè·
å­—å…ƒå¯¬åº¦(cm) = å­—å‹å¤§å°(pt) Ã— 0.0352778 Ã— 0.6  (ç­‰å¯¬å­—å‹ç´„ç‚ºå­—å‹å¤§å°çš„ 60%)
æ¯è¡Œå­—å…ƒæ•¸ = å¯ç”¨å¯¬åº¦ / å­—å…ƒå¯¬åº¦

ä¾‹å¦‚ A4 (21Ã—29.7cm)ï¼Œé‚Šè·å„ 1cmï¼Œå­—å‹ 10ptï¼š
- å¯ç”¨å¯¬åº¦ = 21 - 1 - 1 = 19cm
- å­—å…ƒå¯¬åº¦ â‰ˆ 10 Ã— 0.0352778 Ã— 0.6 â‰ˆ 0.212cm
- æ¯è¡Œå­—å…ƒæ•¸ â‰ˆ 19 / 0.212 â‰ˆ 90 å­—å…ƒ
```

---

## ç›®éŒ„çµæ§‹

```
Services/Reports/
â”œâ”€â”€ Interfaces/                      â† ä»‹é¢å®šç¾©
â”‚   â”œâ”€â”€ IReportService.cs
â”‚   â”œâ”€â”€ IPurchaseOrderReportService.cs
â”‚   â”œâ”€â”€ IPurchaseReceivingReportService.cs
â”‚   â”œâ”€â”€ IPurchaseReturnReportService.cs
â”‚   â”œâ”€â”€ ISalesOrderReportService.cs
â”‚   â”œâ”€â”€ ISalesReturnReportService.cs
â”‚   â”œâ”€â”€ IQuotationReportService.cs
â”‚   â””â”€â”€ IProductBarcodeReportService.cs
â”œâ”€â”€ Configuration/                   â† åˆ—å°é…ç½®æœå‹™
â”‚   â”œâ”€â”€ IReportPrintConfigurationService.cs
â”‚   â””â”€â”€ ReportPrintConfigurationService.cs
â”œâ”€â”€ PurchaseOrderReportService.cs    â† å ±è¡¨æœå‹™å¯¦ä½œï¼ˆç¯„æœ¬ï¼‰
â”œâ”€â”€ PurchaseReceivingReportService.cs
â”œâ”€â”€ PurchaseReturnReportService.cs
â”œâ”€â”€ SalesOrderReportService.cs
â”œâ”€â”€ SalesReturnReportService.cs
â”œâ”€â”€ QuotationReportService.cs
â”œâ”€â”€ ProductBarcodeReportService.cs
â”œâ”€â”€ PlainTextPrintService.cs         â† å…±ç”¨åˆ—å°æœå‹™
â””â”€â”€ ReportPrintService.cs

Helpers/Common/
â””â”€â”€ PlainTextFormatter.cs            â† ç´”æ–‡å­—æ ¼å¼åŒ–å·¥å…·

Controllers/Reports/
â”œâ”€â”€ BaseReportController.cs          â† æ§åˆ¶å™¨åŸºåº•é¡åˆ¥
â”œâ”€â”€ PurchaseReportController.cs      â† æ¡è³¼å ±è¡¨æ§åˆ¶å™¨
â””â”€â”€ SalesReportController.cs         â† éŠ·è²¨å ±è¡¨æ§åˆ¶å™¨

Data/
â””â”€â”€ ReportRegistry.cs                â† å ±è¡¨å®šç¾©è¨»å†Šè¡¨

Models/Reports/
â”œâ”€â”€ ReportModels.cs                  â† å ±è¡¨é…ç½®æ¨¡å‹
â”œâ”€â”€ ReportDefinition.cs              â† å ±è¡¨å®šç¾©
â””â”€â”€ BatchPrintCriteria.cs            â† æ‰¹æ¬¡åˆ—å°æ¢ä»¶
```

---

## æ ¸å¿ƒå…ƒä»¶

### PlainTextFormatterï¼ˆç´”æ–‡å­—æ ¼å¼åŒ–å·¥å…·ï¼‰

ä½ç½®ï¼š`Helpers/Common/PlainTextFormatter.cs`

æä¾›ç´”æ–‡å­—æ ¼å¼åŒ–çš„éœæ…‹æ–¹æ³•ï¼Œè™•ç†ä¸­è‹±æ–‡æ··æ’çš„å¯¬åº¦è¨ˆç®—èˆ‡å°é½Šï¼š

```csharp
public static class PlainTextFormatter
{
    // å¸¸æ•¸
    public const int DefaultLineWidth = 80;  // é è¨­å ±è¡¨å¯¬åº¦
    public const string PageBreak = "\f";    // åˆ†é ç¬¦è™Ÿ

    // æ–‡å­—å°é½Š
    public static string CenterText(string text, int width);
    public static string PadRight(string text, int width);   // å·¦å°é½Š
    public static string PadLeft(string text, int width);    // å³å°é½Š

    // å¯¬åº¦è¨ˆç®—ï¼ˆä¸­æ–‡=2, è‹±æ–‡=1ï¼‰
    public static int GetDisplayWidth(string text);
    public static bool IsWideChar(char c);

    // æ–‡å­—æˆªæ–·
    public static string TruncateText(string text, int maxWidth, bool ellipsis = false);

    // åˆ†éš”ç·š
    public static string Separator(int width);       // â•â•â•â•â•â•â•â•â•â•â•â•
    public static string ThinSeparator(int width);   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    public static string DottedSeparator(int width); // ............

    // è¡¨æ ¼æ ¼å¼åŒ–
    public static string FormatTableRow(IEnumerable<(string Text, int Width, PlainTextAlignment Alignment)> columns);

    // é‡‘é¡èˆ‡æ•¸é‡æ ¼å¼åŒ–
    public static string FormatAmount(decimal amount);              // åƒåˆ†ä½ï¼Œç„¡å°æ•¸
    public static string FormatAmountWithDecimals(decimal amount);  // åƒåˆ†ä½ï¼Œ2ä½å°æ•¸
    public static string FormatQuantity(decimal quantity);          // åƒåˆ†ä½ï¼Œç„¡å°æ•¸

    // æ—¥æœŸæ ¼å¼åŒ–
    public static string FormatDate(DateTime date);        // yyyy/MM/dd
    public static string FormatDateTime(DateTime dateTime); // yyyy/MM/dd HH:mm

    // å ±è¡¨å€å¡Šå»ºæ§‹
    public static string BuildTitleSection(string companyName, string reportTitle, int width);
    public static string BuildSignatureSection(string[] labels, int width);
    public static string BuildTotalLine(string label, decimal amount, string suffix = "");
}

public enum PlainTextAlignment { Left, Right, Center }
```

### PlainTextPrintServiceï¼ˆå…±ç”¨åˆ—å°æœå‹™ï¼‰

ä½ç½®ï¼š`Services/Reports/PlainTextPrintService.cs`

å°è£ Windows åˆ—å°åŠŸèƒ½ï¼Œæä¾›ç´”æ–‡å­—ç›´æ¥åˆ—å°ï¼š

```csharp
public interface IPlainTextPrintService
{
    /// <summary>åŸ·è¡Œç´”æ–‡å­—åˆ—å°</summary>
    ServiceResult PrintText(string textContent, string printerName, string documentName, float fontSize = 10);

    /// <summary>ä½¿ç”¨å ±è¡¨é…ç½®åˆ—å°ï¼ˆè‡ªå‹•æŸ¥è©¢å°è¡¨æ©Ÿè¨­å®šï¼‰</summary>
    Task<ServiceResult> PrintTextByReportIdAsync(string textContent, string reportId, string documentName);

    /// <summary>æª¢æŸ¥æ˜¯å¦æ”¯æ´ç›´æ¥åˆ—å°</summary>
    bool IsDirectPrintSupported();
}
```

åˆ—å°åƒæ•¸ï¼š
- å­—å‹ï¼šCourier Newï¼ˆç­‰å¯¬å­—å‹ï¼‰
- é è¨­å­—å‹å¤§å°ï¼š10pt
- åˆ—å°å¾Œç­‰å¾…æ™‚é–“ï¼š2000ms

---

## å ±è¡¨æœå‹™ä»‹é¢

ä»¥æ¡è³¼å–®ç‚ºä¾‹ï¼š`Services/Reports/Interfaces/IPurchaseOrderReportService.cs`

```csharp
public interface IPurchaseOrderReportService
{
    // ç”Ÿæˆç´”æ–‡å­—å ±è¡¨
    Task<string> GeneratePlainTextReportAsync(int purchaseOrderId);
    Task<string> GenerateBatchPlainTextReportAsync(BatchPrintCriteria criteria);

    // ç›´æ¥åˆ—å°
    Task<ServiceResult> DirectPrintAsync(int purchaseOrderId, string printerName);
    Task<ServiceResult> DirectPrintByReportIdAsync(int purchaseOrderId, string reportId);
    Task<ServiceResult> DirectPrintBatchAsync(BatchPrintCriteria criteria, string reportId);
}
```

---

## å ±è¡¨æœå‹™å¯¦ä½œç¯„æœ¬

ä»¥ `PurchaseOrderReportService.cs` ç‚ºç¯„æœ¬ï¼š

### 1. é¡åˆ¥çµæ§‹

```csharp
public class PurchaseOrderReportService : IPurchaseOrderReportService
{
    private readonly IPurchaseOrderService _purchaseOrderService;
    private readonly ISupplierService _supplierService;
    private readonly IProductService _productService;
    private readonly ICompanyService _companyService;
    private readonly ISystemParameterService _systemParameterService;
    private readonly IReportPrintConfigurationService _reportPrintConfigService;
    private readonly IPrinterConfigurationService _printerConfigService;
    private readonly IPlainTextPrintService _plainTextPrintService;
    private readonly ILogger<PurchaseOrderReportService>? _logger;

    public PurchaseOrderReportService(
        IPurchaseOrderService purchaseOrderService,
        ISupplierService supplierService,
        IProductService productService,
        ICompanyService companyService,
        ISystemParameterService systemParameterService,
        IReportPrintConfigurationService reportPrintConfigService,
        IPrinterConfigurationService printerConfigService,
        IPlainTextPrintService plainTextPrintService,
        ILogger<PurchaseOrderReportService>? logger = null)
    {
        _purchaseOrderService = purchaseOrderService;
        _supplierService = supplierService;
        _productService = productService;
        _companyService = companyService;
        _systemParameterService = systemParameterService;
        _reportPrintConfigService = reportPrintConfigService;
        _printerConfigService = printerConfigService;
        _plainTextPrintService = plainTextPrintService;
        _logger = logger;
    }
}
```

### 2. ç”Ÿæˆç´”æ–‡å­—å ±è¡¨

```csharp
public async Task<string> GeneratePlainTextReportAsync(int purchaseOrderId)
{
    // è¼‰å…¥è³‡æ–™
    var purchaseOrder = await _purchaseOrderService.GetByIdAsync(purchaseOrderId);
    if (purchaseOrder == null)
        throw new ArgumentException($"æ‰¾ä¸åˆ°æ¡è³¼å–® ID: {purchaseOrderId}");

    var orderDetails = await _purchaseOrderService.GetOrderDetailsAsync(purchaseOrderId);

    Supplier? supplier = purchaseOrder.SupplierId > 0
        ? await _supplierService.GetByIdAsync(purchaseOrder.SupplierId)
        : null;

    Company? company = purchaseOrder.CompanyId > 0
        ? await _companyService.GetByIdAsync(purchaseOrder.CompanyId)
        : null;

    var allProducts = await _productService.GetAllAsync();
    var productDict = allProducts.ToDictionary(p => p.Id, p => p);

    // ç”Ÿæˆç´”æ–‡å­—å…§å®¹
    return GeneratePlainTextContent(purchaseOrder, orderDetails, supplier, company, productDict);
}
```

### 3. ç´”æ–‡å­—å…§å®¹ç”Ÿæˆï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰

```csharp
private static string GeneratePlainTextContent(
    PurchaseOrder purchaseOrder,
    List<PurchaseOrderDetail> orderDetails,
    Supplier? supplier,
    Company? company,
    Dictionary<int, Product> productDict)
{
    var sb = new StringBuilder();
    const int lineWidth = PlainTextFormatter.DefaultLineWidth;

    // === æ¨™é¡Œå€ ===
    sb.Append(PlainTextFormatter.BuildTitleSection(
        company?.CompanyName ?? "å…¬å¸åç¨±",
        "æ¡ è³¼ å–®",
        lineWidth));

    // === åŸºæœ¬è³‡è¨Šå€ ===
    sb.AppendLine($"æ¡è³¼å–®è™Ÿï¼š{purchaseOrder.Code,-20} æ¡è³¼æ—¥æœŸï¼š{PlainTextFormatter.FormatDate(purchaseOrder.OrderDate)}");
    sb.AppendLine($"äº¤è²¨æ—¥æœŸï¼š{PlainTextFormatter.FormatDate(purchaseOrder.ExpectedDeliveryDate)}");
    sb.AppendLine(PlainTextFormatter.ThinSeparator(lineWidth));
    sb.AppendLine($"å» å•†åç¨±ï¼š{supplier?.CompanyName ?? ""}");
    sb.AppendLine($"è¯ çµ¡ äººï¼š{supplier?.ContactPerson ?? "",-20} çµ±ä¸€ç·¨è™Ÿï¼š{supplier?.TaxNumber ?? ""}");
    sb.AppendLine($"é€è²¨åœ°å€ï¼š{company?.Address ?? ""}");
    sb.AppendLine(PlainTextFormatter.ThinSeparator(lineWidth));

    // === æ˜ç´°è¡¨é ­ ===
    sb.AppendLine(FormatTableRow("åºè™Ÿ", "å“å", "æ•¸é‡", "å–®ä½", "å–®åƒ¹", "å°è¨ˆ", "å‚™è¨»"));
    sb.AppendLine(PlainTextFormatter.ThinSeparator(lineWidth));

    // === æ˜ç´°å…§å®¹ ===
    int rowNum = 1;
    foreach (var detail in orderDetails)
    {
        var product = productDict.GetValueOrDefault(detail.ProductId);
        var productName = PlainTextFormatter.TruncateText(product?.Name ?? "", 28);
        var remarks = PlainTextFormatter.TruncateText(detail.Remarks ?? "", 8);

        sb.AppendLine(FormatTableRow(
            rowNum.ToString(),
            productName,
            PlainTextFormatter.FormatQuantity(detail.OrderQuantity),
            "å€‹",
            PlainTextFormatter.FormatAmountWithDecimals(detail.UnitPrice),
            PlainTextFormatter.FormatAmountWithDecimals(detail.SubtotalAmount),
            remarks
        ));
        rowNum++;
    }

    sb.AppendLine(PlainTextFormatter.ThinSeparator(lineWidth));

    // === åˆè¨ˆå€ ===
    var taxMethodText = purchaseOrder.TaxCalculationMethod switch
    {
        TaxCalculationMethod.TaxExclusive => "å¤–åŠ ç¨…",
        TaxCalculationMethod.TaxInclusive => "å…§å«ç¨…",
        TaxCalculationMethod.NoTax => "å…ç¨…",
        _ => ""
    };

    sb.AppendLine(PlainTextFormatter.BuildTotalLine("å°ã€€è¨ˆ", purchaseOrder.TotalAmount));
    sb.AppendLine(PlainTextFormatter.BuildTotalLine("ç¨…ã€€é¡", purchaseOrder.PurchaseTaxAmount, taxMethodText));
    sb.AppendLine(PlainTextFormatter.BuildTotalLine("ç¸½ã€€è¨ˆ", purchaseOrder.PurchaseTotalAmountIncludingTax));

    // === å‚™è¨» ===
    if (!string.IsNullOrWhiteSpace(purchaseOrder.Remarks))
    {
        sb.AppendLine(PlainTextFormatter.ThinSeparator(lineWidth));
        sb.AppendLine($"å‚™è¨»ï¼š{purchaseOrder.Remarks}");
    }

    sb.AppendLine(PlainTextFormatter.Separator(lineWidth));

    // === ç°½åå€ ===
    sb.Append(PlainTextFormatter.BuildSignatureSection(
        new[] { "æ¡è³¼äººå“¡", "æ ¸å‡†äººå“¡", "æ”¶è²¨ç¢ºèª" },
        lineWidth));

    return sb.ToString();
}
```

### 4. è¡¨æ ¼è¡Œæ ¼å¼åŒ–ï¼ˆå„å ±è¡¨è‡ªè¨‚ï¼‰

```csharp
/// <summary>
/// æ ¼å¼åŒ–è¡¨æ ¼è¡Œ - æ¡è³¼å–®å°ˆç”¨æ ¼å¼
/// æ¬„ä½é…ç½®ï¼šåºè™Ÿ(4) | å“å(30) | æ•¸é‡(8) | å–®ä½(6) | å–®åƒ¹(10) | å°è¨ˆ(12) | å‚™è¨»(10)
/// </summary>
private static string FormatTableRow(string col1, string col2, string col3, string col4, string col5, string col6, string col7)
{
    return PlainTextFormatter.FormatTableRow(new (string, int, PlainTextAlignment)[]
    {
        (col1, 4, PlainTextAlignment.Left),
        (col2, 30, PlainTextAlignment.Left),
        (col3, 8, PlainTextAlignment.Right),
        (col4, 6, PlainTextAlignment.Left),
        (col5, 10, PlainTextAlignment.Right),
        (col6, 12, PlainTextAlignment.Right),
        (col7, 10, PlainTextAlignment.Left)
    });
}
```

### 5. ç›´æ¥åˆ—å°æ–¹æ³•

```csharp
[SupportedOSPlatform("windows6.1")]
public async Task<ServiceResult> DirectPrintAsync(int purchaseOrderId, string printerName)
{
    try
    {
        var textContent = await GeneratePlainTextReportAsync(purchaseOrderId);

        _logger?.LogInformation("é–‹å§‹ç›´æ¥åˆ—å°æ¡è³¼å–® {OrderId}ï¼Œå°è¡¨æ©Ÿï¼š{PrinterName}", purchaseOrderId, printerName);

        // ä½¿ç”¨å…±ç”¨åˆ—å°æœå‹™
        var printResult = _plainTextPrintService.PrintText(textContent, printerName, $"æ¡è³¼å–®-{purchaseOrderId}");

        if (printResult.IsSuccess)
            _logger?.LogInformation("æ¡è³¼å–® {OrderId} åˆ—å°å®Œæˆ", purchaseOrderId);

        return printResult;
    }
    catch (Exception ex)
    {
        _logger?.LogError(ex, "ç›´æ¥åˆ—å°æ¡è³¼å–® {OrderId} æ™‚ç™¼ç”ŸéŒ¯èª¤", purchaseOrderId);
        return ServiceResult.Failure($"åˆ—å°æ™‚ç™¼ç”ŸéŒ¯èª¤: {ex.Message}");
    }
}

[SupportedOSPlatform("windows6.1")]
public async Task<ServiceResult> DirectPrintByReportIdAsync(int purchaseOrderId, string reportId)
{
    try
    {
        var textContent = await GeneratePlainTextReportAsync(purchaseOrderId);

        _logger?.LogInformation("é–‹å§‹åˆ—å°æ¡è³¼å–® {OrderId}ï¼Œä½¿ç”¨é…ç½®ï¼š{ReportId}", purchaseOrderId, reportId);

        // ä½¿ç”¨å…±ç”¨åˆ—å°æœå‹™ï¼ˆè‡ªå‹•æŸ¥è©¢å°è¡¨æ©Ÿé…ç½®ï¼‰
        return await _plainTextPrintService.PrintTextByReportIdAsync(textContent, reportId, $"æ¡è³¼å–®-{purchaseOrderId}");
    }
    catch (Exception ex)
    {
        _logger?.LogError(ex, "ä½¿ç”¨é…ç½®åˆ—å°æ¡è³¼å–® {OrderId} æ™‚ç™¼ç”ŸéŒ¯èª¤", purchaseOrderId, reportId);
        return ServiceResult.Failure($"åˆ—å°æ™‚ç™¼ç”ŸéŒ¯èª¤: {ex.Message}");
    }
}
```

---

## ç´”æ–‡å­—å ±è¡¨è¼¸å‡ºç¯„ä¾‹

```
================================================================================
                            å…¬å¸åç¨±æœ‰é™å…¬å¸
                              æ¡ è³¼ å–®
================================================================================
æ¡è³¼å–®è™Ÿï¼šPO-20260203-001      æ¡è³¼æ—¥æœŸï¼š2026/02/03
äº¤è²¨æ—¥æœŸï¼š2026/02/10
--------------------------------------------------------------------------------
å» å•†åç¨±ï¼šæ¸¬è©¦å» å•†è‚¡ä»½æœ‰é™å…¬å¸
è¯ çµ¡ äººï¼šå¼µå…ˆç”Ÿ              çµ±ä¸€ç·¨è™Ÿï¼š12345678
é€è²¨åœ°å€ï¼šå°åŒ—å¸‚ä¿¡ç¾©å€xxxè·¯xxxè™Ÿ
--------------------------------------------------------------------------------
åºè™Ÿ å“å                           æ•¸é‡     å–®ä½     å–®åƒ¹       å°è¨ˆ     å‚™è¨»
--------------------------------------------------------------------------------
1    æ¸¬è©¦å•†å“A                        10     å€‹     100.00    1,000.00
2    æ¸¬è©¦å•†å“B                         5     å€‹     200.00    1,000.00
3    é€™æ˜¯ä¸€å€‹å¾ˆé•·çš„å•†å“åç¨±æœƒè¢«..       3     å€‹     500.00    1,500.00
--------------------------------------------------------------------------------
                                                  å°ã€€è¨ˆï¼š       3,500
                                                  ç¨…ã€€é¡ï¼š         175 (å¤–åŠ ç¨…)
                                                  ç¸½ã€€è¨ˆï¼š       3,675
================================================================================

æ¡è³¼äººå“¡ï¼š________________    æ ¸å‡†äººå“¡ï¼š________________    æ”¶è²¨ç¢ºèªï¼š________________

================================================================================
```

---

## å‰ç«¯çµ„ä»¶å‘¼å«æ–¹å¼

ä»¥ `PurchaseOrderEditModalComponent.razor` ç‚ºç¯„æœ¬ï¼š

### 1. æ³¨å…¥æœå‹™

```razor
@using ERPCore2.Services.Reports
@inject IPurchaseOrderReportService PurchaseOrderReportService
@inject IPrinterConfigurationService PrinterConfigurationService
@inject IReportPrintConfigurationService ReportPrintConfigurationService
```

### 2. åˆ—å°æŒ‰éˆ•è™•ç†

```csharp
/// <summary>
/// è™•ç†åˆ—å°æŒ‰éˆ•é»æ“Š
/// </summary>
private async Task HandlePrint()
{
    try
    {
        // æª¢æŸ¥æ˜¯å¦å·²å„²å­˜
        if (!canPrint)
        {
            await NotificationService.ShowWarningAsync("è«‹å…ˆå„²å­˜æ¡è³¼å–®");
            return;
        }

        // æª¢æŸ¥ Entity æ˜¯å¦å·²è¼‰å…¥
        if (editModalComponent?.Entity == null)
        {
            await NotificationService.ShowWarningAsync("ç„¡æ³•åˆ—å°ï¼šæ¡è³¼å–®è³‡æ–™ä¸å­˜åœ¨");
            return;
        }

        // æª¢æŸ¥å¯©æ ¸ç‹€æ…‹ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
        if (isApprovalEnabled && !editModalComponent.Entity.IsApproved)
        {
            await NotificationService.ShowWarningAsync("æ­¤æ¡è³¼å–®å°šæœªå¯©æ ¸é€šéï¼Œç„¡æ³•åˆ—å°");
            return;
        }

        // åŸ·è¡Œåˆ—å°
        await HandleDirectPrint(null);
    }
    catch (Exception ex)
    {
        await NotificationService.ShowErrorAsync("åˆ—å°è™•ç†æ™‚ç™¼ç”ŸéŒ¯èª¤");
    }
}

/// <summary>
/// åŸ·è¡Œç›´æ¥åˆ—å°
/// </summary>
private async Task HandleDirectPrint(ReportPrintConfiguration? printConfig)
{
    try
    {
        if (editModalComponent?.Entity == null)
        {
            await NotificationService.ShowWarningAsync("ç„¡æ³•åˆ—å°ï¼šæ¡è³¼å–®è³‡æ–™ä¸å­˜åœ¨");
            return;
        }

        // å–å¾—å°è¡¨æ©Ÿåç¨±
        string? printerName = null;

        // æ–¹å¼ 1ï¼šå¾å‚³å…¥çš„åˆ—å°é…ç½®å–å¾—
        if (printConfig?.PrinterConfigurationId.HasValue == true)
        {
            var printerConfig = await PrinterConfigurationService.GetByIdAsync(printConfig.PrinterConfigurationId.Value);
            printerName = printerConfig?.Name;
        }

        // æ–¹å¼ 2ï¼šå¾å ±è¡¨é…ç½®å–å¾—ï¼ˆä½¿ç”¨é è¨­å ±è¡¨ IDï¼‰
        if (string.IsNullOrEmpty(printerName))
        {
            var reportConfig = await ReportPrintConfigurationService.GetByReportIdAsync("PO001");
            if (reportConfig?.PrinterConfigurationId.HasValue == true)
            {
                var printerConfig = await PrinterConfigurationService.GetByIdAsync(reportConfig.PrinterConfigurationId.Value);
                printerName = printerConfig?.Name;
            }
        }

        if (string.IsNullOrEmpty(printerName))
        {
            await NotificationService.ShowWarningAsync("è«‹å…ˆè¨­å®šæ¡è³¼å–®çš„åˆ—å°å°è¡¨æ©Ÿ");
            return;
        }

        // ç›´æ¥å‘¼å«æœå‹™åˆ—å°ï¼ˆä¸ç¶“é APIï¼‰
        var result = await PurchaseOrderReportService.DirectPrintAsync(
            editModalComponent.Entity.Id,
            printerName
        );

        if (result.IsSuccess)
        {
            await NotificationService.ShowSuccessAsync($"å·²é€å‡ºåˆ—å°åˆ°å°è¡¨æ©Ÿï¼š{printerName}");
        }
        else
        {
            await NotificationService.ShowErrorAsync($"åˆ—å°å¤±æ•—ï¼š{result.ErrorMessage}");
        }
    }
    catch (Exception ex)
    {
        await NotificationService.ShowErrorAsync("åˆ—å°åŸ·è¡Œæ™‚ç™¼ç”ŸéŒ¯èª¤");
    }
}
```

---

## API æ§åˆ¶å™¨

ä½ç½®ï¼š`Controllers/Reports/PurchaseReportController.cs`

```csharp
[Route("api/purchase-report")]
[ApiController]
public class PurchaseReportController : BaseReportController
{
    private readonly IPurchaseOrderReportService _purchaseOrderReportService;

    /// <summary>
    /// å–å¾—æ¡è³¼å–®ç´”æ–‡å­—å ±è¡¨ï¼ˆé è¦½ç”¨ï¼‰
    /// </summary>
    [HttpGet("order/{id}")]
    public async Task<IActionResult> GetPurchaseOrderReport(int id)
    {
        try
        {
            var plainText = await _purchaseOrderReportService.GeneratePlainTextReportAsync(id);
            var html = WrapPlainTextAsHtml(plainText, $"æ¡è³¼å–®å ±è¡¨ - {id}");
            return Content(html, "text/html; charset=utf-8");
        }
        catch (ArgumentException ex)
        {
            return NotFound(new { message = ex.Message });
        }
    }

    /// <summary>
    /// æ¡è³¼å–®ç›´æ¥åˆ—å°
    /// </summary>
    [HttpPost("order/{id}/direct")]
    public async Task<IActionResult> DirectPrintPurchaseOrder(int id, [FromQuery] string reportId = "PO001")
    {
        try
        {
            var result = await _purchaseOrderReportService.DirectPrintByReportIdAsync(id, reportId);

            if (result.IsSuccess)
                return Ok(new { success = true, message = "åˆ—å°æˆåŠŸ" });
            else
                return BadRequest(new { success = false, message = result.ErrorMessage });
        }
        catch (Exception ex)
        {
            return StatusCode(500, new { message = "åˆ—å°æ™‚ç™¼ç”ŸéŒ¯èª¤", detail = ex.Message });
        }
    }
}
```

---

## å ±è¡¨åˆ—å°é…ç½®

### ReportRegistryï¼ˆå ±è¡¨å®šç¾©ï¼‰

ä½ç½®ï¼š`Data/ReportRegistry.cs`

```csharp
public static class ReportRegistry
{
    public static List<ReportDefinition> GetAllReports()
    {
        return new List<ReportDefinition>
        {
            new ReportDefinition
            {
                Id = "PO001",
                Name = "æ¡è³¼å–®",
                Description = "æ¡è³¼å–®åˆ—å°å ±è¡¨",
                Category = ReportCategory.Purchase,
                RequiredPermission = "PurchaseOrder.Read",
                IsEnabled = true
            },
            // ... å…¶ä»–å ±è¡¨å®šç¾©
        };
    }
}
```

### ReportPrintConfigurationï¼ˆè³‡æ–™è¡¨ï¼‰

ä½¿ç”¨è€…å¯åœ¨ã€Œå ±è¡¨åˆ—å°é…ç½®ã€é é¢è¨­å®šæ¯å€‹å ±è¡¨çš„å°è¡¨æ©Ÿå’Œç´™å¼µï¼š

| æ¬„ä½ | èªªæ˜ |
|------|------|
| ReportId | å ±è¡¨è­˜åˆ¥ç¢¼ï¼ˆå°æ‡‰ ReportRegistry.Idï¼‰ |
| ReportName | å ±è¡¨åç¨± |
| PrinterConfigurationId | å°è¡¨æ©Ÿè¨­å®š FK |
| PaperSettingId | ç´™å¼µè¨­å®š FK |

### è‡ªå‹•å»ºç«‹é…ç½®

`ReportPrintConfigurationSeeder` åœ¨æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚ï¼š
1. è®€å– `ReportRegistry.GetAllReports()`
2. è‡ªå‹•å»ºç«‹å°šæœªå­˜åœ¨çš„ `ReportPrintConfiguration` è¨˜éŒ„
3. å·²å­˜åœ¨çš„é…ç½®ä¸æœƒè¢«è¦†è“‹

---

## æ–°å¢å ±è¡¨æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šå®šç¾©å ±è¡¨

åœ¨ `Data/ReportRegistry.cs` æ–°å¢ï¼š

```csharp
new ReportDefinition
{
    Id = "XX001",
    Name = "æ–°å ±è¡¨åç¨±",
    Description = "å ±è¡¨èªªæ˜",
    Category = ReportCategory.Sales,
    RequiredPermission = "Entity.Read",
    IsEnabled = true
}
```

### æ­¥é©Ÿ 2ï¼šå»ºç«‹ä»‹é¢

åœ¨ `Services/Reports/Interfaces/` æ–°å¢ `INewReportService.cs`ï¼š

```csharp
public interface INewReportService
{
    Task<string> GeneratePlainTextReportAsync(int entityId);
    Task<string> GenerateBatchPlainTextReportAsync(BatchPrintCriteria criteria);
    Task<ServiceResult> DirectPrintAsync(int entityId, string printerName);
    Task<ServiceResult> DirectPrintByReportIdAsync(int entityId, string reportId);
    Task<ServiceResult> DirectPrintBatchAsync(BatchPrintCriteria criteria, string reportId);
}
```

### æ­¥é©Ÿ 3ï¼šå»ºç«‹å¯¦ä½œ

åœ¨ `Services/Reports/` æ–°å¢ `NewReportService.cs`ï¼Œåƒè€ƒ `PurchaseOrderReportService` çš„çµæ§‹ã€‚

### æ­¥é©Ÿ 4ï¼šè¨»å†Šæœå‹™

åœ¨ `Data/ServiceRegistration.cs` æ–°å¢ï¼š

```csharp
services.AddScoped<ERPCore2.Services.Reports.Interfaces.INewReportService, NewReportService>();
```

### æ­¥é©Ÿ 5ï¼šå»ºç«‹æ§åˆ¶å™¨ç«¯é»

åœ¨é©ç•¶çš„æ§åˆ¶å™¨æ–°å¢ç«¯é»ï¼Œæˆ–å»ºç«‹æ–°æ§åˆ¶å™¨ç¹¼æ‰¿ `BaseReportController`ã€‚

### æ­¥é©Ÿ 6ï¼šé‡æ–°å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼

Seeder æœƒè‡ªå‹•åœ¨ã€Œå ±è¡¨åˆ—å°é…ç½®ã€é é¢å»ºç«‹æ–°å ±è¡¨çš„é…ç½®è¨˜éŒ„ã€‚

---

## å¹³å°é™åˆ¶

| é …ç›® | èªªæ˜ |
|------|------|
| ç›´æ¥åˆ—å°åŠŸèƒ½ | åƒ…æ”¯æ´ Windows å¹³å°ï¼ˆä½¿ç”¨ System.Drawing.Printingï¼‰ |
| æœå‹™è¨»å†Š | ä½¿ç”¨ `OperatingSystem.IsWindowsVersionAtLeast(6, 1)` æª¢æŸ¥ |
| å±¬æ€§æ¨™è¨˜ | ä½¿ç”¨ `[SupportedOSPlatform("windows6.1")]` æ¨™è¨˜æ–¹æ³• |

---

## ç¾æœ‰å ±è¡¨æ¸…å–®

| å ±è¡¨ ID | å ±è¡¨åç¨± | æœå‹™é¡åˆ¥ | ç‹€æ…‹ |
|---------|---------|---------|------|
| PO001 | æ¡è³¼å–® | PurchaseOrderReportService | âœ… å·²å¯¦ä½œ |
| PR001 | é€²è²¨å–® | PurchaseReceivingReportService | âœ… å·²å¯¦ä½œ |
| PT001 | é€²è²¨é€€å‡ºå–® | PurchaseReturnReportService | âœ… å·²å¯¦ä½œ |
| SO001 | éŠ·è²¨å–® | SalesOrderReportService | âœ… å·²å¯¦ä½œ |
| SR001 | éŠ·è²¨é€€å›å–® | SalesReturnReportService | âœ… å·²å¯¦ä½œ |
| QT001 | å ±åƒ¹å–® | QuotationReportService | âœ… å·²å¯¦ä½œ |
