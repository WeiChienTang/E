# 印表機測試列印功能 - 快速使用指南

## 🚀 功能啟用

新的測試列印功能已經完全整合到印表機配置編輯組件中，無需額外設定即可使用。

## 📋 使用步驟

### 在印表機配置編輯中使用

1. **開啟印表機配置**
   - 前往系統設定 → 印表機配置
   - 點擊「新增」或「編輯」現有印表機

2. **填寫印表機資訊**
   ```
   印表機名稱: [必填] 例如: "辦公室印表機"
   連接方式: [選擇] 網路連接 或 USB連接
   ```

3. **設定連接參數**
   
   **網路印表機:**
   ```
   IP位址: [必填] 例如: 192.168.1.100
   連接埠: [必填] 例如: 9100
   ```
   
   **USB印表機:**
   ```
   USB埠: [選填] 例如: LPT1, USB001
   ```

4. **執行測試列印**
   - 點擊Modal底部的「測試列印」按鈕
   - 系統會自動驗證配置並執行測試
   - 查看測試結果通知

### 使用測試頁面（開發/除錯用）

1. **存取測試頁面**
   - 瀏覽至: `/printer-test`
   - 或在程式中導航至 `PrinterTestPage.razor`

2. **執行獨立測試**
   - 分別測試網路印表機和USB印表機
   - 即時查看測試結果和錯誤訊息
   - 預覽測試頁內容

## ⚠️ 常見問題解決

### 網路印表機問題

**問題: "無法ping通印表機IP"**
```
解決方案:
1. 檢查IP位址是否正確
2. 確認印表機已連接到網路
3. 檢查防火牆設定
4. 嘗試手動ping印表機IP
```

**問題: "連接埠無回應"**
```
解決方案:
1. 確認連接埠號碼正確（通常是9100）
2. 檢查印表機是否支援網路列印
3. 聯絡網管確認埠是否開放
```

### USB印表機問題

**問題: "找不到USB埠"**
```
解決方案:
1. 檢查印表機是否正確連接
2. 確認驅動程式已安裝
3. 嘗試不同的USB埠選項
4. 重新啟動印表機
```

### 一般問題

**問題: "印表機配置無效"**
```
解決方案:
1. 確保所有必填欄位已填寫
2. 檢查IP位址格式（IPv4）
3. 確認連接埠在1-65535範圍內
```

## 🔧 開發者注意事項

### 服務依賴

確保以下服務已正確註冊：
```csharp
services.AddScoped<IPrinterConfigurationService, PrinterConfigurationService>();
services.AddScoped<IPrinterTestService, PrinterTestService>();
```

### 權限要求

- 網路印表機: 需要網路存取權限
- USB印表機: 需要系統列印服務權限

### 自訂測試邏輯

如需客製化測試邏輯，可以繼承 `PrinterTestService` 或實作 `IPrinterTestService`：

```csharp
public class CustomPrinterTestService : PrinterTestService
{
    public override async Task<ServiceResult> TestPrintAsync(PrinterConfiguration config)
    {
        // 自訂測試邏輯
        return await base.TestPrintAsync(config);
    }
}
```

## 📊 測試頁內容

系統會自動產生包含以下資訊的測試頁：

- 測試時間戳記
- 印表機配置詳情
- 中英文字體測試
- 數字和符號測試
- 列印確認訊息

## 🎯 效能優化

- 網路測試超時: 5秒
- 連接重試: 無自動重試（避免阻塞UI）
- 背景執行: 所有測試操作都在背景執行

## 📈 監控和記錄

- 所有測試操作都會記錄到系統日誌
- 錯誤詳情會通過ErrorHandlingHelper處理
- 使用者會收到即時的成功/失敗通知

這個功能讓使用者可以在設定印表機後立即驗證配置是否正確，大大減少了因配置錯誤導致的列印問題。
